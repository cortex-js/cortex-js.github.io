"use strict";(self.webpackChunkcortexjs_io=self.webpackChunkcortexjs_io||[]).push([[1951],{2651:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"mathfield/interacting","title":"Interacting with a Mathfield","description":"Changing the Content of a Mathfield","source":"@site/docs/mathfield/11-interacting.md","sourceDirName":"mathfield","slug":"/mathfield/guides/interacting/","permalink":"/mathfield/guides/interacting/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1737956976000,"sidebarPosition":11,"frontMatter":{"date":"Last Modified","title":"Interacting with a Mathfield","slug":"/mathfield/guides/interacting/"},"sidebar":"docSidebar","previous":{"title":"Using Svelte","permalink":"/mathfield/guides/svelte/"},"next":{"title":"Customize","permalink":"/mathfield/guides/customizing/"}}');var s=n(4848),d=n(8453);const l={date:"Last Modified",title:"Interacting with a Mathfield",slug:"/mathfield/guides/interacting/"},o="Interacting with a Mathfield",a={},r=[{value:"Changing the Content of a Mathfield",id:"changing-the-content-of-a-mathfield",level:2},{value:"Reading the Content of a Mathfield",id:"reading-the-content-of-a-mathfield",level:2},{value:"Using a Mathfield with the Compute Engine",id:"using-a-mathfield-with-the-compute-engine",level:2},{value:"Listening for Changes to a Mathfield",id:"listening-for-changes-to-a-mathfield",level:2},{value:"Detecting When the User has Finished Editing a Mathfield",id:"detecting-when-the-user-has-finished-editing-a-mathfield",level:2},{value:"Detecting a Click on a Mathfield",id:"detecting-a-click-on-a-mathfield",level:2},{value:"Detecting Navigation out of a Mathfield",id:"detecting-navigation-out-of-a-mathfield",level:2},{value:"Interacting with the Clipboard",id:"interacting-with-the-clipboard",level:2},{value:"Applying Style to a Mathfield",id:"applying-style-to-a-mathfield",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code","code-playground":"code-playground",div:"div",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components},n=t["code-playground"],{Icon:i,ReadMore:l}=t;return i||x("Icon",!0),l||x("ReadMore",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"interacting-with-a-mathfield",children:"Interacting with a Mathfield"})}),"\n",(0,s.jsx)(t.h2,{id:"changing-the-content-of-a-mathfield",children:"Changing the Content of a Mathfield"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["To change the value of a ",(0,s.jsx)(t.code,{children:"<math-field>"})," element programatically"]})," set its ",(0,s.jsx)(t.code,{children:"value"}),"\nproperty."]}),"\n",(0,s.jsxs)(t.p,{children:["In the playground below, the ",(0,s.jsx)(t.strong,{children:"LaTeX"})," input field is editable and is reflected\nin the mathfield, and vice-versa."]}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["Note that we use the ",(0,s.jsx)(t.code,{children:"silenceNotifications"})," option when\nchanging the content of the mathfield, to prevent an ",(0,s.jsx)(t.code,{children:'"input"'})," event from being\ntriggered and creating an infinite loop."]})}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsxs)(t.div,{slot:"html",children:["<label>Mathfield</label>\n",'<math-field id="formula">\n',"    ","x=\\frac{-b\\pm \\sqrt{b^2-4ac}}{2a}\n","</math-field>\n","<label>Latex</label>\n",'<textarea id="latex" autocapitalize="off" autocomplete="off"\n',"  ",'autocorrect="off" spellcheck="false"></textarea>\n']}),(0,s.jsxs)(t.div,{slot:"javascript",children:['const mf = document.getElementById("formula");\n','const latex = document.getElementById("latex");\n',"//\n",'mf.addEventListener("input",(ev) => latex.value = mf.value);\n',"//\n","latex.value = mf.value;\n","//\n",'// Listen for changes in the "latex" text field,\n',"// and reflect its value in the mathfield.\n","//\n",'latex.addEventListener("input", (ev) =>\n',"    ","mf.setValue(\n","      ","ev.target.value,\n","      ","{silenceNotifications: true}\n","    ",")\n",");\n","\n"]})]}),"\n",(0,s.jsx)(t.h2,{id:"reading-the-content-of-a-mathfield",children:"Reading the Content of a Mathfield"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["To read the content of a ",(0,s.jsx)(t.code,{children:"<math-field>"})," element as a LaTeX string"]})," use its ",(0,s.jsx)(t.code,{children:"value"})," property,\njust like with a ",(0,s.jsx)(t.code,{children:"<textarea>"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To be notified when the content of the mathfield is modified"})," listen for\nan ",(0,s.jsx)(t.code,{children:'"input"'})," event."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Try"}),": modify the ",(0,s.jsx)(t.code,{children:'"input"'})," event below to a ",(0,s.jsx)(t.code,{children:'"change"'})," event. Notice how the ",(0,s.jsx)(t.code,{children:'"change"'})," event\nis only sent if you press the ",(0,s.jsx)("kbd",{children:"RETURN"})," or ",(0,s.jsx)("kbd",{children:"ENTER"})," key, or when the mathfield\nloses focus and the content has been modified."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsxs)(t.div,{slot:"html",children:['<math-field id="formula">\n',"  ","x=\\frac{-b\\pm \\sqrt{b^2-4ac}}{2a}\n","</math-field>\n"]}),(0,s.jsxs)(t.div,{slot:"javascript",children:["document.getElementById('formula').addEventListener('input',(ev) => {\n","  ","// `ev.target` is an instance of `MathfieldElement`\n","  ","console.log(ev.target.value);\n","});\n","\n"]})]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.p,{children:["Reading the ",(0,s.jsx)(t.code,{children:"value"})," property is equivalent to calling the ",(0,s.jsx)(t.code,{children:"getValue()"})," method with\nno argument."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To control the format of the result"}),", pass options to ",(0,s.jsx)(t.a,{href:"/docs/mathfield/#(%22mathfield-element%22%3Amodule).(MathfieldElement%3Aclass).(getValue%3Ainstance)",children:(0,s.jsx)(t.code,{children:"getValue()"})}),".\nFor example to get the content as a MathJSON expression, use ",(0,s.jsx)(t.code,{children:"mf.getValue('math-json')"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Try:"})," ",(0,s.jsx)(t.a,{href:"/docs/mathfield/#(%22mathfield%22%3Amodule).(OutputFormat%3Atype)",children:"Other formats"})," are available: change ",(0,s.jsx)(t.code,{children:'"math-json"'})," to ",(0,s.jsx)(t.code,{children:'"spoken-text"'}),"."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsxs)(t.div,{slot:"html",children:['<math-field id="formula">\n',"  ","x=\\frac{-b\\pm \\sqrt{b^2-4ac}}{2a}\n","</math-field>\n","\n"]}),(0,s.jsxs)(t.div,{slot:"javascript",children:["import 'compute-engine';\n","const mf = document.getElementById('formula');\n","\n","// `ev.target` is an instance of `MathfieldElement`\n","mf.addEventListener('input',\n","  ","(ev) => console.log(ev.target.getValue('math-json'))\n",");\n"]})]}),"\n",(0,s.jsx)(t.h2,{id:"using-a-mathfield-with-the-compute-engine",children:"Using a Mathfield with the Compute Engine"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"/math-json",children:"MathJSON"})," format is a lightweight mathematical notation interchange format."]}),"\n",(0,s.jsx)(t.p,{children:"The Compute Engine is a JavaScript library that can perform\nmathematical operations on MathJSON expressions."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To use the Compute Engine"}),", import the Compute Engine library, e.g. ",(0,s.jsx)(t.code,{children:'import "https://unpkg.com/@cortex-js/compute-engine?module"'})]}),"\n",(0,s.jsx)(t.p,{children:"If the Compute Engine has been loaded in the page, mathfields will automatically\ncreate an instance of the compute engine when needed."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To access that shared Compute Engine instance"}),", use ",(0,s.jsx)(t.code,{children:"MathfieldElement.computeEngine"}),"."]}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["If the value returned is ",(0,s.jsx)(t.code,{children:"undefined"}),", it means that the Compute Engine has not\nbeen loaded in the page."]})}),"\n",(0,s.jsxs)(t.p,{children:["You can also create your own instance of the Compute Engine and pass it to the\nmathfield using the ",(0,s.jsx)(t.code,{children:"computeEngine"})," property."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",metastring:"example",children:"import { ComputeEngine } from 'compute-engine';\nMathfieldElement.computeEngine = new ComputeEngine();\n"})}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsx)(t.p,{children:"This is usually not necessary and you can rely on the default shared instance\nof the Compute Engine."})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["To read the content of a ",(0,s.jsx)(t.code,{children:"<math-field>"})," element as a boxed MathJSON expression"]})," use the mathfield ",(0,s.jsx)(t.code,{children:"expression"})," property."]}),"\n",(0,s.jsxs)(t.p,{children:["Using ",(0,s.jsx)(t.code,{children:"mf.expression"})," is equivalent to calling ",(0,s.jsx)(t.code,{children:"MathfieldElement.computeEngine.parse(mf.value)"})," or ",(0,s.jsx)(t.code,{children:'MathfieldElement.computeEngine.box(mf.getValue("math-json"))'}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Once you have a boxed expression, you can perform operations on it using the\nCompute Engine."}),"\n",(0,s.jsx)(t.p,{children:"For example, you can:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/compute-engine/guides/evaluate/",children:"evaluate it"})," using ",(0,s.jsx)(t.code,{children:"mf.expression.evaluate()"})]}),"\n",(0,s.jsxs)(t.li,{children:["simplify it using ",(0,s.jsx)(t.code,{children:"mf.expression.simplify()"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/compute-engine/guides/symbolic-computing/#comparing-expressions",children:"compare it to another expression"})," using ",(0,s.jsx)(t.code,{children:"mf.expression.isEqual()"})," and\n",(0,s.jsx)(t.code,{children:"mf.expression.isSame()"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/compute-engine/guides/compiling/",children:"compile it"})," to JavaScript"]}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["Note that the expressions are returned by default in a canonical form, which means that\nthey may be different from the original input. For example, ",(0,s.jsx)(t.code,{children:"x + 1"})," and ",(0,s.jsx)(t.code,{children:"1 + x"}),"\nare considered equal, and will be returned as ",(0,s.jsx)(t.code,{children:"1 + x"}),". If necessary you\ncan request non-canonical forms."]})}),"\n",(0,s.jsx)(l,{path:"/compute-engine/guides/canonical-form/",children:(0,s.jsxs)(t.p,{children:["Learn more about ",(0,s.jsx)(t.strong,{children:"canonical forms"}),".",(0,s.jsx)(i,{name:"chevron-right-bold"})]})}),"\n",(0,s.jsxs)(t.p,{children:["You can also extend the definitions of the Compute Engine ",(0,s.jsx)(t.a,{href:"/compute-engine/guides/augmenting/",children:"by adding your own"}),"."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsxs)(t.div,{slot:"html",children:['<math-field id="formula">\n',"  ","\\mathrm{Expand}((a+b)^6)\n","</math-field>\n","\n"]}),(0,s.jsxs)(t.div,{slot:"javascript",children:["import 'compute-engine';\n","const mf = document.getElementById('formula');\n","mf.addEventListener('input', () =>\n","  ","console.log(mf.expression.evaluate())\n",");\n","console.log(mf.expression.evaluate());\n"]})]}),"\n",(0,s.jsx)(l,{path:"/compute-engine/guides/symbolic-computing/",children:(0,s.jsxs)(t.p,{children:["Learn more about ",(0,s.jsx)(t.strong,{children:"symbolic computing"})," with the Compute Engine",(0,s.jsx)(i,{name:"chevron-right-bold"})]})}),"\n",(0,s.jsx)(t.h2,{id:"listening-for-changes-to-a-mathfield",children:"Listening for Changes to a Mathfield"}),"\n",(0,s.jsxs)(t.p,{children:["The mathfield element dispatches the ",(0,s.jsx)(t.code,{children:"beforeinput"})," and ",(0,s.jsx)(t.code,{children:"input"}),"\n",(0,s.jsx)(t.a,{href:"https://www.w3.org/TR/input-events-1/",children:"Input Events"}),", which are also\nimplemented by ",(0,s.jsx)(t.code,{children:"<textarea>"})," and similar elements."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"beforeinput"})," and ",(0,s.jsx)(t.code,{children:"input"})," events implement the ",(0,s.jsx)(t.code,{children:"InputEvent"})," interface."]}),"\n",(0,s.jsxs)(t.p,{children:["These events are sent before (",(0,s.jsx)(t.code,{children:"beforeinput"})," event) and after (",(0,s.jsx)(t.code,{children:"input"})," event) a\nuser attempts to edit the mathfield. This includes insertion and deletion of\ncontent, and formatting changes."]}),"\n",(0,s.jsxs)(t.p,{children:["The events include an ",(0,s.jsx)(t.code,{children:"inputType"})," property that describe what caused the event\nto be dispatched."]}),"\n",(0,s.jsx)("div",{className:"symbols-table first-column-header",style:{"--first-col-width":"21ch"},children:(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"inputType"})}),(0,s.jsx)(t.th,{style:{textAlign:"left"}})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"insertText"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Some content was added. It could be math content, plain text or raw latex. It could also be a row or column in matrix that was added."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"insertLineBreak"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["The ",(0,s.jsx)("kbd",{children:"RETURN"})," or ",(0,s.jsx)("kbd",{children:"ENTER"})," key was pressed. Note that the actual content of the mathfield may not have changed."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"insertFromPaste"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"The content of the mathfield was changed because of a paste operation"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteWordBackward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteWordForward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteWordForward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteSoftLineBackward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteSoftLineForward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteHardLineBackward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteHardLineForward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteByCut"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"The content was changed because of a cut operation"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteContent"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Some content was deleted, but no particular direction applied"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteContentBackward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"deleteContentForward"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"historyUndo"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"The content was changed because of an undo command"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"historyRedo"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"The content was changed because of a redo command"})]})]})]})}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsxs)(t.p,{children:["On iOS, the ",(0,s.jsx)(t.code,{children:"inputType"})," property is removed. However, its content can also be access as ",(0,s.jsx)(t.code,{children:"ev.data"}),". Until this issue is addressed in iOS, for better compatibility, use ",(0,s.jsx)(t.code,{children:"ev.data"}),"."]})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"beforeinput"})," event is dispatched before any modifications to the mathfield\nhave been done. This event is cancelable. Calling ",(0,s.jsx)(t.code,{children:"preventDefault()"})," on the\nevent will cause the modification to be prevented."]}),"\n",(0,s.jsxs)(t.p,{children:["If the ",(0,s.jsx)(t.code,{children:"beforeinput"})," event is not canceled, the mathfield content is modified\nand a ",(0,s.jsx)(t.code,{children:"input"})," event is dispatched. The ",(0,s.jsx)(t.code,{children:"input"})," event is not cancelable."]}),"\n",(0,s.jsx)(t.h2,{id:"detecting-when-the-user-has-finished-editing-a-mathfield",children:"Detecting When the User has Finished Editing a Mathfield"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["To detect when the user presses the ",(0,s.jsx)("kbd",{children:"RETURN"})," or ",(0,s.jsx)("kbd",{children:"ENTER"})," key in a mathfield"]}),",\nlisten for the ",(0,s.jsx)(t.code,{children:"change"})," event."]}),"\n",(0,s.jsxs)(t.p,{children:["Note that this event is not fired when in LaTeX editing mode, where ",(0,s.jsx)(t.strong,{children:"Return"}),"\nor ",(0,s.jsx)(t.strong,{children:"Enter"})," is used to exit the mode."]}),"\n",(0,s.jsxs)(t.p,{children:["This event is also fired if the mathfield loses focus, even if the user did not\nuse the keyboard. This behavior matches the ",(0,s.jsx)(t.code,{children:"<textarea>"})," element."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["To listen specifically for a press of the ",(0,s.jsx)("kbd",{children:"RETURN"})," or ",(0,s.jsx)("kbd",{children:"ENTER"})," key on the\nkeyboard"]})," listen for an ",(0,s.jsx)(t.code,{children:"input"})," event with an ",(0,s.jsx)(t.code,{children:"inputType"}),"\n(or ",(0,s.jsx)(t.code,{children:"ev.data"})," on iOS) property of ",(0,s.jsx)(t.code,{children:'"insertLineBreak"'}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"mf.addEventListener('beforeinput', (ev) => {\n  if (ev.inputType === 'insertLineBreak') {\n    mf.executeCommand(\"moveToNextPlaceholder\");\n    ev.preventDefault();\n  };\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"detecting-a-click-on-a-mathfield",children:"Detecting a Click on a Mathfield"}),"\n",(0,s.jsx)(t.p,{children:"In most cases MathLive will respond to mouse and keyboard interactions with\nthe mathfield. However, in some cases it might be useful to detect when a\nmathfield is clicked on. For example, you could display one or more read-only\nmathfields in a list and prompt the user to pick one by clicking on it."}),"\n",(0,s.jsxs)(t.p,{children:["In general, to be notified of an event, use ",(0,s.jsx)(t.code,{children:"mf.addEventListener()"}),". This\nincludes some generic events, as well as some that are specific to mathfields."]}),"\n",(0,s.jsxs)(t.p,{children:["Events that target a DOM element inside the mathfield (inside the shadow DOM)\nwill bubble and be retargeted to appear as if they had targeted the\nmathfield (that is, the ",(0,s.jsx)(t.code,{children:"evt.target"})," will be the mathfield itself)."]}),"\n",(0,s.jsx)(t.p,{children:"This include the following standard events:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"change"}),": the ",(0,s.jsx)("kbd",{children:"RETURN"})," or ",(0,s.jsx)("kbd",{children:"ENTER"})," key was pressed, or the field lost focus."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"blur"}),", ",(0,s.jsx)(t.code,{children:"focus"}),", ",(0,s.jsx)(t.code,{children:"focusin"}),", ",(0,s.jsx)(t.code,{children:"focusout"})]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"click"})}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"mousedown"}),", ",(0,s.jsx)(t.code,{children:"mouseup"}),", ",(0,s.jsx)(t.code,{children:"mousemove"}),", ",(0,s.jsx)(t.code,{children:"mouseout, "}),"mouseover`"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"beforeinput"}),", ",(0,s.jsx)(t.code,{children:"input"}),". If the ",(0,s.jsx)(t.code,{children:"inputType"})," property of the event is ",(0,s.jsx)(t.code,{children:'"insertLineBreak"'})," the ",(0,s.jsx)("kbd",{children:"RETURN"})," or ",(0,s.jsx)("kbd",{children:"ENTER"})," key was pressed"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"keydown"}),", ",(0,s.jsx)(t.code,{children:"keypress"}),", ",(0,s.jsx)(t.code,{children:"keyup"})]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"wheel"})}),"\n",(0,s.jsxs)(t.li,{children:["all the ",(0,s.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events",children:"pointer events"})," such as ",(0,s.jsx)(t.code,{children:"pointerdown"}),", ",(0,s.jsx)(t.code,{children:"pointerup"}),", etc... and all the touch events"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"As well as these mathfield specific events:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"mount"}),": the mathfield has been connected to the DOM"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"unmount"}),": the mathfield is no longer connected to the DOM"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"focus-out"}),": tab key interactions"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"move-out"}),": arrow key interactions"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"mode-change"}),": change to ",(0,s.jsx)(t.code,{children:"math"}),", ",(0,s.jsx)(t.code,{children:"text"})," or ",(0,s.jsx)(t.code,{children:"latex"})," mode"]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"read-aloud-status-change"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"selection-change"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"undo-state-change"})}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"detecting-navigation-out-of-a-mathfield",children:"Detecting Navigation out of a Mathfield"}),"\n",(0,s.jsx)(t.p,{children:"A user may navigate outside of a mathfield by pressing the arrow keys, or the tab, home and end keys."}),"\n",(0,s.jsxs)(t.p,{children:["By default, the mathfield reacts as a standard textarea field: moving to the next focusable element when the ",(0,s.jsx)("kbd",{children:"TAB"})," (or ",(0,s.jsx)("kbd",{children:"SHIFT+TAB"}),") key is pressed, and\ndoing nothing when reaching the start or end of the mathfield when navigation with the arrow keys."]}),"\n",(0,s.jsxs)(t.p,{children:["In some cases, you may want to implement a different behavior. For example if a mathfield is embedded inside an editable paragraph, you may want the arrow keys to exit the mathfield when reaching the end/start. Or you may want the ",(0,s.jsx)("kbd",{children:"TAB"})," key to simply move the caret to the end/start of the mathfield."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To change the behavior of a mathfield when navigation out of a mathfield"})," listen\nfor the ",(0,s.jsx)(t.code,{children:"focus-out"})," and ",(0,s.jsx)(t.code,{children:"move-out"})," events."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"detail"})," property of those events indicate the direction of navigation.\nTo cancel the default behavior, use ",(0,s.jsx)(t.code,{children:"ev.preventDefault()"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"mf.addEventListener('move-out', (ev) => {\nev.preventDefault();\n  // Remove focus from mathfield\n  mf.blur();\n  // Focus some other element, use ev.detail.direction to detect if \n  // navigating backward, forward, upward or downward\n  // ...\n});\n\nmf.addEventListener('focus-out', (ev) => {\n  ev.preventDefault();\n  // Move the cursor to the start/end of the mathfield on tab\n  if (ev.detail.direction === 'forward')\n    mf.executeCommand('moveToMathfieldEnd');\n  else if (ev.detail.direction === 'backward')\n    mf.executeCommand('moveToMathfieldStart');\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"interacting-with-the-clipboard",children:"Interacting with the Clipboard"}),"\n",(0,s.jsxs)(t.p,{children:["Users can export the content of the mathfield by using standard ",(0,s.jsx)(t.strong,{children:"Copy"}),"/",(0,s.jsx)(t.strong,{children:"Cut"}),"\ncommands (",(0,s.jsx)("kbd",{children:"Control/\u2318"})," ",(0,s.jsx)("kbd",{children:"X"})," and ",(0,s.jsx)("kbd",{children:"Control/\u2318"})," ",(0,s.jsx)("kbd",{children:"C"}),")."]}),"\n",(0,s.jsx)(t.p,{children:"Multiple flavors are put on the clipboard:"}),"\n",(0,s.jsx)("div",{className:"symbols-table first-column-header",children:(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"}}),(0,s.jsx)(t.th,{style:{textAlign:"left"}})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"text/plain"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["LaTeX wrapped with a ",(0,s.jsx)(t.code,{children:"$$"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"application/x-latex"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Raw LaTeX"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"application/json"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"A MathJSON representation of the formula."})]})]})]})}),"\n",(0,s.jsxs)(t.p,{children:["The recipient of the ",(0,s.jsx)(t.strong,{children:"Paste"})," operation can pick whichever is most appropriate.\nIf the recipient is a web app, the specific flavor can be accessed using\nthe ",(0,s.jsx)(t.code,{children:"event.clipboardData.getData()"})," API. If the recipient is a native app,\nthe most popular browsers currently only make accessible the text flavor,\nwith a LaTeX representation of the formula."]}),"\n",(0,s.jsxs)(t.p,{children:["The LaTeX in the ",(0,s.jsx)(t.code,{children:"text/plain"}),' flavor is "wrapped" to make it easier for the\nrecipient of the paste to recognize that this content is in LaTeX format.']}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["For improved interoperability, the exported LaTeX uses the ",(0,s.jsx)(t.code,{children:"latex-expanded"}),"\nformat. In this format, any macros in the formula are expanded to their\ndefinition. For example, the ",(0,s.jsx)(t.code,{children:"\\differentialD"})," command is exported as its\ncorresponding definition, ",(0,s.jsx)(t.code,{children:"\\mathrm{d}"}),"."]})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["To customize the content of the ",(0,s.jsx)(t.code,{children:"text/plain"})," flavor"]}),", use the ",(0,s.jsx)(t.code,{children:"onExport()"})," hook."]}),"\n",(0,s.jsxs)(t.p,{children:["For example, to wrap the exported latex with ",(0,s.jsx)(t.code,{children:"<math>...</math>"})," instead:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"mf.onExport = (mf, latex) => `<math>${latex}</math>`\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:'To export the "raw" (not expanded) LaTeX)'}),", use:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"mf.onExport = (mf, latex, range) => `$$${mf.getValue(range, 'latex')}$$`\n"})}),"\n",(0,s.jsx)(t.p,{children:"The exported format doesn't have to be LaTeX. To export ASCIIMath instead:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:'mf.onExport = (mf, latex, range) => \n    "`" + mf.getValue(range, \'ascii-math\') + "`"\n'})}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["The standard delimiter for ASCIIMath is the ",(0,s.jsx)("kbd",{children:"`"})," (backtick) character"]})}),"\n",(0,s.jsx)(t.h2,{id:"applying-style-to-a-mathfield",children:"Applying Style to a Mathfield"}),"\n",(0,s.jsxs)(t.p,{children:['The text color ("ink") and background color ("paper"), as well as other\nstylistic attributes, can be changed on a mathfield, or a portion of a mathfield\nusing ',(0,s.jsx)(t.code,{children:"applyStyle()"}),"."]}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["This style applies to the content of the formula and will be reflected in the\nLaTeX output. To change the appearance of the mathfield but not\nthe content of the formula, see ",(0,s.jsx)(t.a,{href:"/mathfield/guides/customizing/",children:"Customizing"}),"."]})}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsxs)(t.div,{slot:"html",children:['<math-field id="formula">\n',"  ","x=\\frac{-b\\pm \\sqrt{b^2-4ac}}{2a}\n","</math-field>\n"]}),(0,s.jsxs)(t.div,{slot:"javascript",children:["const mf = document.getElementById('formula');\n","\n","// Change the background color of the entire mathfield\n","mf.applyStyle(\n","  ","{ backgroundColor: 'yellow' },\n","  ","{ range: [0, -1] }\n",");\n","\n"]})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To change the style of a portion of the mathfield"}),", specify a selection range\nto ",(0,s.jsx)(t.code,{children:"applyStyle()"}),"."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsxs)(t.div,{slot:"html",children:['<math-field id="formula">\n',"  ","x=\\frac{-b\\pm \\sqrt{b^2-4ac}}{2a}\n","</math-field>\n"]}),(0,s.jsxs)(t.div,{slot:"javascript",children:["const mf = document.getElementById('formula');\n","\n","// Change the color and size of the first two characters of the mathfield\n",'mf.applyStyle({color: "red", fontSize: 7 }, { range: [0, 2] });\n',"\n"]})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"To remove a style"}),", set the value of the ",(0,s.jsx)(t.code,{children:"fontFamily"}),", ",(0,s.jsx)(t.code,{children:"color"})," or ",(0,s.jsx)(t.code,{children:"backgroundColor"}),"\nproperty to ",(0,s.jsx)(t.code,{children:'"none"'}),", or the value of the ",(0,s.jsx)(t.code,{children:"fontShape"}),", ",(0,s.jsx)(t.code,{children:"fontSeries"})," or ",(0,s.jsx)(t.code,{children:"fontSize"}),"\nproperty to ",(0,s.jsx)(t.code,{children:'"auto"'}),"."]}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(t.p,{children:["You can ignore styles applied to a formula by using ",(0,s.jsx)(t.code,{children:"mf.getValue('latex-unstyled')"})]})})]})}function h(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}function x(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var i=n(6540);const s={},d=i.createContext(s);function l(e){const t=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(d.Provider,{value:t},e.children)}}}]);